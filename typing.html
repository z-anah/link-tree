<html>

<head>
    <style>
        .text-to-copy {
            color: rgb(191, 190, 190);
        }

        .text-typed {
            color: black;
        }

        .container {
            text-align: center;
            padding-top: 200px;
            font-size: xx-large;
        }

        table {
            margin: 0 auto;
            text-align: center;
        }


        .highlight {
            color: rgb(191, 190, 190);
            text-decoration: underline;
        }
    </style>
</head>

<body>
    <div id="container" class="container">
        <div id="text-to-copy" class="text-to-copy">test</div>
        <br>
        <table>
            <tr>
                <td><button id="e_acute">é</button></td>
                <td><button id="e_grave">è</button></td>
                <td><button id="e_flexe">ê</button></td>
                <td><button id="e_o">œ</button></td>
                <td><button id="a_flexe">â</button></td>
            </tr>
            <tr class="text-to-copy">
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                <td>5</td>
            </tr>
        </table>
    </div>
    <script src="la_fiche_de_revision_du_theme_la_culture.js"></script>
    <script>
        let textToCopy = document.getElementById("text-to-copy");
        let container = document.getElementById("container");

        const e_acute = document.getElementById("e_acute");
        const e_grave = document.getElementById("e_grave");
        const e_o = document.getElementById("e_o");
        const e_flexe = document.getElementById("e_flexe");
        const a_flexe = document.getElementById("a_flexe");

        var iChar = 0;
        const words = la_fiche_de_revision_du_theme_la_culture.typing;
        let iWords = 0;

        function styleIt(originalText, iChar) {
            return '<span class="text-typed">'
                + originalText.slice(0, iChar)
                + '</span>'
                + '<span class="highlight">'
                + originalText.charAt(iChar)
                + '</span>'
                + '<span class="text-to-copy">'
                + originalText.slice(iChar + 1)
                + '</span>';
        }

        function checkType(key) {
            if (key === originalText[iChar]) {
                var iCharPrim = iChar + 1;
                const newTextPrim = styleIt(originalText, iCharPrim);
                textToCopy.innerHTML = newTextPrim;
                iChar++;
                // const audioType = new Audio('https://github.com/z-anah/link-tree/blob/main/mixkit-single-key-type-2533.wav?raw=true');
                // audioType.play();
            }
            else if (iChar === originalText.length - 1) {
                setTimeout(function () {
                    iWords++;
                    if (iWords === words.length) {
                        alert("Bravo! Choisir un niveau!");
                        textToCopy.innerHTML = "...";
                        return;
                    }
                    iChar = 0;
                    iCharPrim = 0;
                    originalText = words[iWords];
                    newText = styleIt(originalText, iChar);
                    textToCopy.innerHTML = newText;
                    return;
                }, 250);
            }
        }

        e_acute.addEventListener("click", function () {
            let key = "é";
            checkType(key);
        });

        e_grave.addEventListener("click", function () {
            let key = "è";
            checkType(key);
        });

        e_o.addEventListener("click", function () {
            let key = "œ";
            checkType(key);
        });

        e_flexe.addEventListener("click", function () {
            let key = "ê";
            checkType(key);
        });

        a_flexe.addEventListener("click", function () {
            let key = "â";
            checkType(key);
        });

        document.addEventListener("keydown", function (event) {
            let key = null;
            if (event.key === "1") {
                key = "é";
            } else if (event.key === "2") {
                key = "è";
            } else if (event.key === "3") {
                key = "ê";
            } else if (event.key === "4") {
                key = "œ";
            } else if (event.key === "5") {
                key = "â";
            }
            checkType(key);
        });


        document.onkeydown = function (event) {
            let key = event.key;
            checkType(key);
        };

        let originalText = words[iWords];
        let newText = styleIt(originalText, iChar);
        textToCopy.innerHTML = newText;
    </script>
</body>

</html>
